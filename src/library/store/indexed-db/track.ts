import { Track } from 'app/src-core/library';
import { TrackStore } from 'app/src-core/library/store/track';
import { omit } from 'lodash';
import { LibraryDatabase } from './db';

export class IndexedDbTrackStore implements TrackStore {
  constructor(private db: LibraryDatabase) {}

  async add(tracks: Track<any>[]): Promise<void> {
    // ignore any provided ids so that it can be auto generated by IndexedDb
    const tracksToInsert = tracks.map((track) => omit(track, 'id'));
    await this.db.bulkAddTracks(tracksToInsert);
  }
}
